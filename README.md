# Payroll System

> ‚ö†Ô∏è **Status**: This project is currently in progress and under active development.

A modern full-stack payroll management system built with Laravel and Vue.js. This application provides a comprehensive solution for managing employees, user authentication, and role-based access control.

## üöÄ Features

- **Authentication & Authorization**
  - Secure login and registration
  - Role-based access control (Admin, Employee)
  - Laravel Sanctum for session-based authentication
  - CSRF protection

- **Employee Management**
  - Create, read, update, and delete employees
  - Employee profile management
  - Search and filter employees
  - Employee ID management

- **Admin Dashboard**
  - Overview dashboard with statistics
  - Employee management interface
  - User management capabilities
  - Settings management (placeholder routes)

- **Employee Dashboard**
  - Personal profile view
  - Employee information display

- **Modern UI/UX**
  - Responsive design with Vuetify
  - Clean and intuitive interface
  - Global loading indicators
  - Form validation with Zod and VeeValidate

## üì∏ Screenshots

<div align="center">
  <img src="screenshots/Screenshot1.png" alt="Screenshot 1" width="800"/>
  <p><em>Screenshot 1</em></p>
</div>

<div align="center">
  <img src="screenshots/Screenshot2.png" alt="Screenshot 2" width="800"/>
  <p><em>Screenshot 2</em></p>
</div>

<div align="center">
  <img src="screenshots/Screenshot3.png" alt="Screenshot 3" width="800"/>
  <p><em>Screenshot 3</em></p>
</div>

<div align="center">
  <img src="screenshots/Screenshot4.png" alt="Screenshot 4" width="800"/>
  <p><em>Screenshot 4</em></p>
</div>

<div align="center">
  <img src="screenshots/Screenshot5.png" alt="Screenshot 5" width="800"/>
  <p><em>Screenshot 5</em></p>
</div>

<div align="center">
  <img src="screenshots/Screenshot6.png" alt="Screenshot 6" width="800"/>
  <p><em>Screenshot 6</em></p>
</div>

## üõ†Ô∏è Tech Stack

### Backend
- **Framework**: Laravel 12
- **PHP**: 8.2+
- **Database**: SQLite (configurable)
- **Authentication**: Laravel Sanctum
- **Authorization**: Spatie Laravel Permission
- **Testing**: Pest PHP

### Frontend
- **Framework**: Vue 3 (Composition API)
- **Language**: TypeScript
- **UI Library**: Vuetify 3
- **State Management**: Pinia
- **Data Fetching**: TanStack Vue Query
- **Form Validation**: VeeValidate + Zod
- **Routing**: Vue Router 4
- **Build Tool**: Vite
- **Testing**: Vitest, Cypress, Playwright

## üìã Prerequisites

Before you begin, ensure you have the following installed:

- **PHP** >= 8.2
- **Composer** >= 2.0
- **Node.js** >= 20.19.0 or >= 22.12.0
- **npm** >= 9.0
- **SQLite** (or MySQL/PostgreSQL if preferred)

## üîß Installation

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd payroll
   ```

2. **Backend Setup**
   ```bash
   cd backend
   
   # Install PHP dependencies
   composer install
   
   # Copy environment file
   cp .env.example .env
   
   # Generate application key
   php artisan key:generate
   
   # Create database file (SQLite)
   touch database/database.sqlite
   
   # Run migrations
   php artisan migrate
   
   # Seed the database (creates admin user and roles)
   php artisan db:seed
   ```

3. **Frontend Setup**
   ```bash
   cd frontend
   
   # Install Node dependencies
   npm install
   ```

4. **Environment Configuration**

   **Backend** (`.env` in `backend/` directory):
   ```env
   APP_NAME="Payroll System"
   APP_ENV=local
   APP_KEY=(generated by artisan key:generate)
   APP_DEBUG=true
   APP_URL=http://localhost:8000
   
   DB_CONNECTION=sqlite
   DB_DATABASE=/absolute/path/to/backend/database/database.sqlite
   
   SESSION_DRIVER=file
   SESSION_LIFETIME=120
   
   SANCTUM_STATEFUL_DOMAINS=localhost:5173
   
   # Queue Configuration (Redis)
   QUEUE_CONNECTION=redis
   CACHE_STORE=redis
   
   # Redis Configuration
   REDIS_HOST=127.0.0.1
   REDIS_PASSWORD=null
   REDIS_PORT=6379
   REDIS_DB=0
   REDIS_CACHE_DB=1
   
   # Email Configuration (Mailpit for local development)
   # Mailpit web UI: http://localhost:8025/
   # Mailpit SMTP: localhost:1025
   MAIL_MAILER=smtp
   MAIL_HOST=127.0.0.1
   MAIL_PORT=1025
   MAIL_USERNAME=null
   MAIL_PASSWORD=null
   MAIL_ENCRYPTION=null
   MAIL_FROM_ADDRESS="noreply@yourapp.test"
   MAIL_FROM_NAME="${APP_NAME}"
   
   # Invitation Email Configuration
   INVITATION_LOGO_URL=/images/logo.png
   INVITATION_PRIMARY_COLOR=#1976D2
   FRONTEND_URL=http://localhost:5173
   ```

   **Frontend** (`.env` in `frontend/` directory):
   ```env
   VITE_API_BASE_URL=http://localhost:8000/api/v1
   VITE_WEB_BASE_URL=http://localhost:8000
   ```

## üèÉ Running the Application

### Development Mode

**Option 1: Run separately**

Backend (Terminal 1):
```bash
cd backend
php artisan serve
```
Backend will run on `http://localhost:8000`

Frontend (Terminal 2):
```bash
cd frontend
npm run dev
```
Frontend will run on `http://localhost:5173`

**Queue Worker (Terminal 3):**
```bash
cd backend
php artisan queue:work database --queue=emails
```

**Option 2: Run together (Backend script)**

From the root directory:
```bash
cd backend
composer run dev
```
This will concurrently run the Laravel server, queue worker, logs, and Vite dev server.

### Queue Worker

The application uses database queues for background job processing (e.g., sending invitation emails). You need to run a queue worker:

```bash
cd backend
php artisan queue:work database --queue=emails
```

**For Development:**
```bash
# Run queue worker in the background
php artisan queue:work database --queue=emails --tries=5 --timeout=60
```

**For Production:**
```bash
# Use supervisor or systemd to keep the worker running
# See Laravel documentation for production queue setup
php artisan queue:work database --queue=emails --tries=5 --timeout=60 --sleep=3 --max-jobs=1000
```

**Note:** 
- The application is configured to use Redis queues. Make sure Redis server is running and the PHP Redis extension is installed.
- If Redis is not available, you can fall back to database queues by changing `QUEUE_CONNECTION=redis` to `QUEUE_CONNECTION=database` in `.env`.
- Consider using [Laravel Horizon](https://laravel.com/docs/horizon) for a better queue management dashboard in production.

### Email Testing (Mailpit)

For local development, the application is configured to use [Mailpit](https://github.com/axllent/mailpit) for email testing:

- **Web UI**: http://localhost:8025/
- **SMTP Port**: 1025
- **Configuration**: Already set in `.env` with `MAIL_HOST=127.0.0.1` and `MAIL_PORT=1025`

All emails sent by the application (including invitation emails) will be captured by Mailpit and can be viewed in the web interface.

### Redis Setup

**Install Redis Server:**

**macOS:**
```bash
brew install redis
brew services start redis
```

**Ubuntu/Debian:**
```bash
sudo apt-get install redis-server
sudo systemctl start redis
sudo systemctl enable redis
```

**Windows:**
- Download Redis from [redis.io](https://redis.io/download) or use WSL2

**Install PHP Redis Extension:**

**Ubuntu/Debian:**
```bash
sudo apt-get update
sudo apt-get install php-redis
sudo systemctl restart php8.3-fpm  # Adjust version as needed
```

**Using PECL (if apt package not available):**
```bash
sudo pecl install redis
# Add 'extension=redis.so' to php.ini
sudo systemctl restart php8.3-fpm  # Adjust version as needed
```

**Verify Redis is running:**
```bash
redis-cli ping
# Should return: PONG
```

**Verify PHP Redis extension is installed:**
```bash
php -m | grep redis
# Should return: redis
```

**Configuration:**
The `.env` file is already configured for Redis:
- `QUEUE_CONNECTION=redis`
- `CACHE_STORE=redis`
- `REDIS_HOST=127.0.0.1`
- `REDIS_PORT=6379`

### Production Build

**Backend:**
```bash
cd backend
composer install --optimize-autoloader --no-dev
php artisan config:cache
php artisan route:cache
php artisan view:cache
```

**Frontend:**
```bash
cd frontend
npm run build
```
Built files will be in `frontend/dist/`

## üîê Default Credentials

After seeding the database, you can login with:

- **Email**: `admin@example.com`
- **Password**: `password`

‚ö†Ô∏è **Important**: Change the default password immediately in production!

## üë• Creating Admin Users

See the [CREATE_ADMIN_USER.md](backend/CREATE_ADMIN_USER.md) file for detailed instructions on creating admin users. Quick methods:

**Using Seeder:**
```bash
php artisan db:seed --class=AdminUserSeeder
```

**Using Artisan Command:**
```bash
php artisan make:admin \
  --first-name="Admin" \
  --last-name="User" \
  --email="admin@example.com" \
  --password="your-secure-password"
```

## üß™ Testing

### Backend Tests
```bash
cd backend
composer test
# or
php artisan test
```

### Frontend Tests

**Unit Tests:**
```bash
cd frontend
npm run test:unit
```

**E2E Tests (Cypress):**
```bash
npm run test:e2e:dev
```

**E2E Tests (Playwright):**
```bash
npx playwright install
npm run test:e2e
```

**Type Checking:**
```bash
npm run type-check
```

**Linting:**
```bash
npm run lint
```

## üìÅ Project Structure

```
payroll/
‚îú‚îÄ‚îÄ backend/                 # Laravel backend application
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Console/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Exceptions/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Http/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Controllers/    # API controllers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Requests/       # Form request validation
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Resources/      # API resources
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Responses/      # Response classes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Models/             # Eloquent models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Policies/           # Authorization policies
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Providers/          # Service providers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Services/           # Business logic services
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ migrations/         # Database migrations
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seeders/            # Database seeders
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.php             # API routes
‚îÇ   ‚îî‚îÄ‚îÄ tests/                  # Pest tests
‚îÇ
‚îî‚îÄ‚îÄ frontend/               # Vue.js frontend application
    ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îú‚îÄ‚îÄ assets/         # Static assets (CSS, images)
    ‚îÇ   ‚îú‚îÄ‚îÄ components/     # Vue components
    ‚îÇ   ‚îú‚îÄ‚îÄ composables/    # Vue composables
    ‚îÇ   ‚îú‚îÄ‚îÄ layouts/        # Layout components
    ‚îÇ   ‚îú‚îÄ‚îÄ lib/            # Utility libraries (axios, etc.)
    ‚îÇ   ‚îú‚îÄ‚îÄ pages/          # Page components
    ‚îÇ   ‚îú‚îÄ‚îÄ plugins/        # Vue plugins
    ‚îÇ   ‚îú‚îÄ‚îÄ router/         # Vue Router configuration
    ‚îÇ   ‚îú‚îÄ‚îÄ stores/         # Pinia stores
    ‚îÇ   ‚îú‚îÄ‚îÄ types/          # TypeScript types
    ‚îÇ   ‚îú‚îÄ‚îÄ validation/     # Validation schemas
    ‚îÇ   ‚îî‚îÄ‚îÄ views/          # View components
    ‚îú‚îÄ‚îÄ cypress/            # Cypress E2E tests
    ‚îî‚îÄ‚îÄ e2e/                # Playwright E2E tests
```

## üîå API Endpoints

### Authentication
- `POST /api/v1/login` - User login
- `POST /api/v1/logout` - User logout
- `POST /api/v1/register` - User registration
- `GET /api/v1/user` - Get current authenticated user

### Employees (Protected - Admin Only)
- `GET /api/v1/employees` - List all employees
- `POST /api/v1/employees` - Create new employee
- `GET /api/v1/employees/{id}` - Get employee details
- `PUT /api/v1/employees/{id}` - Update employee
- `DELETE /api/v1/employees/{id}` - Delete employee

All API routes are prefixed with `/api/v1` and protected routes require authentication via Laravel Sanctum.

## üé® UI Components

The frontend uses Vuetify components with a custom theme. Key components include:

- **DashboardLayout**: Main layout with sidebar navigation and app bar
- **EmployeesList**: Employee management table with filtering and actions
- **AdminDashboard**: Admin overview dashboard
- **EmployeeDashboard**: Employee profile dashboard

## üîí Security Features

- CSRF protection for all state-changing operations
- Session-based authentication with Laravel Sanctum
- Role-based access control (RBAC) using Spatie Permission
- Password hashing using bcrypt
- XSS protection via Vue.js automatic escaping
- CORS configuration for API security

## üêõ Troubleshooting

### Common Issues

**401 Unauthorized errors:**
- Ensure cookies are enabled in your browser
- Check that `SANCTUM_STATEFUL_DOMAINS` includes your frontend domain
- Verify session configuration in `.env`

**Database errors:**
- Ensure SQLite file exists: `touch backend/database/database.sqlite`
- Check file permissions on the database file
- Run migrations: `php artisan migrate:fresh --seed`

**Frontend build errors:**
- Clear node_modules: `rm -rf node_modules && npm install`
- Check Node.js version: `node --version` (should be >= 20.19.0)

**CORS issues:**
- Update `config/cors.php` with your frontend URL
- Ensure `SANCTUM_STATEFUL_DOMAINS` matches your frontend domain

## üìù Development Guidelines

### Code Style

**Backend:**
- Follow PSR-12 coding standards
- Use Laravel Pint for code formatting: `composer pint`

**Frontend:**
- Follow Vue.js style guide
- Use ESLint for linting: `npm run lint`
- Use Prettier for formatting: `npm run format`

### Commit Messages
- Use clear, descriptive commit messages
- Reference issue numbers when applicable

## üìÑ License

This project is open-sourced software licensed under the [MIT license](https://opensource.org/licenses/MIT).

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## üìö Additional Documentation

- [Backend API Routes Analysis](backend/API_ROUTES_ANALYSIS.md)
- [Create Admin User Guide](backend/CREATE_ADMIN_USER.md)
- [Frontend Developer Guide](frontend/DEVELOPER_GUIDE.md)
- [Validation Guide](frontend/VALIDATION_GUIDE.md)

## üôè Acknowledgments

- [Laravel](https://laravel.com) - The PHP Framework
- [Vue.js](https://vuejs.org) - The Progressive JavaScript Framework
- [Vuetify](https://vuetifyjs.com) - Material Design Component Framework
- [Spatie](https://spatie.be) - Laravel Permission Package
